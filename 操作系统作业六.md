# 操作系统作业六

## 1.寻道时间

### （1）先来先服务

移动距离：5+25+15+50+68+1+35=199

寻道时间：199*6=1194ms

### （2）最短寻道时间

寻道顺序：15、10、3、2、20、35、38、70

移动距离：13+68=81

寻道时间：81*6=486ms

### （3）SCAN算法

寻道顺序：15、20、35、38、70、85、10、3、2

移动距离：70+83=153

寻道时间：153*6=918ms

### （4）LOOK算法

寻道顺序：15、20、35、38、70、10、3、2

移动距离：55+68=123

寻道时间：123*6=738ms

## 2.I/O缓冲区

保存进程高频率访问的磁盘块，减少对磁盘块的访问，提升IO速度。

单缓冲区：将文件从磁盘读到用户区需要8*（100+50）=1200μs，CPU分析可以和IO读入并行，实际需要50μs，共1250μs。

双缓冲区：将数据读入缓冲区和从缓冲区读入用户区可以并行，实际共需8*100+100=900μs。

## 3.提升文件系统性能

1. **文件系统设计优化：** 采用高效的数据结构和算法来管理文件和目录，以减少文件系统操作的时间复杂度。
2. **缓存机制：** 实现有效的缓存策略，将常用的文件和数据块缓存在内存中，减少对磁盘的访问次数，提高读写速度。
3. **磁盘调度算法：** 使用合适的磁盘调度算法来优化磁盘访问顺序，减少磁盘寻道时间和旋转延迟，如使用SSTF（Shortest Seek Time First）或者SCAN算法等。
4. **文件系统日志：** 引入日志机制，记录文件系统的操作，以防止数据丢失或损坏，提高文件系统的稳定性和可靠性。
5. **磁盘空间管理：** 使用合适的磁盘分配算法，如位图、索引节点等，有效地管理磁盘空间，减少碎片化，提高文件系统的存储利用率。
6. **并发控制：** 实现有效的并发控制机制，确保多个进程或线程可以安全地访问文件系统，避免数据的冲突和丢失。
7. **预读取和延迟写入：** 实现预读取和延迟写入机制，提前读取文件内容到缓存中，或者将数据先写入缓存而不是直接写入磁盘，以减少磁盘访问的等待时间。

## 4.文件控制块管理的主要信息

* 基本信息
  * 文件名：字符串，通常在不同系统中允许不同的最大长度，可修改
  * 物理位置
  * 文件逻辑结构：有/无结构（记录文件，流式文件）
  * 文件物理结构：（如顺序，索引等）
* 访问控制信息
  * 文件所有者（属主）：通常是创建文件的用户，或者改变已有文件的属主
  * 访问权限（控制各用户可使用的访问方式）：如读、写、执行、删除等
* 使用信息
  * 创建时间，上一次修改时间，当前使用信息等。

## 5.目录访问

* 1次第二级目录项。128个三级目录项被存在16个物理块中，所以平均读取8.5次三级目录项。一个文件平均100个物理块，访问其中的随机一个平均需要访问50.5次。因此总共60次。
* 访问二级目录i节点1次，二级目录内容1次；访问三级目录i节点1次，一个目录项占14+2字节，所以一个物理块64个目录项，所以访问三级目录块内容平均1.5次；访问磁盘块的i节点1次，访问磁盘块1次。共6.5次。
* 文件系统最多纪录16ZB/1KB=2^64个磁盘块，需要8字节来保存。inode中的索引区可以放512/8=64个磁盘块，一级索引指向的磁盘块中可存储1KB/8B=128个磁盘块号，所以支持的最大文件为8MB。